<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <include resource="org/springframework/boot/logging/logback/defaults.xml" />
  <!-- This configuration will apply to all specified profiles -->
  <springProfile name="default | prod | dev">

    <!-- Define a consistent pattern for log messages -->
    <property name="defaultPattern" value="%d{yyyy-MM-dd} | %d{HH:mm:ss.SSS} | %5p | %thread | %lo{50} | %m%n" />

    <!--
    CONSOLE Appender (STDOUT)
    This is the only appender needed for Cloud Run. It prints logs to the standard output,
    where Google Cloud's logging service can automatically collect them.
    -->
    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
      <encoder>
        <pattern>${defaultPattern}</pattern>
        <charset>utf8</charset>
      </encoder>
    </appender>

    <!-- Set the log level for your application's packages -->
    <logger name="com.investment" level="INFO"/>

    <!--
    Configure the logger for the Spring Framework.
    It will now ONLY send logs to the console.
    'additivity="false"' prevents duplicate logs in the root logger.
    -->
    <logger name="org.springframework" level="INFO" additivity="false">
      <appender-ref ref="STDOUT" />
    </logger>

    <!--        Root Logger Configuration
    This is the final logger that catches all other log messages.
    It is now configured to ONLY send output to the console (STDOUT).
    The reference to the file appender has been removed.
    -->
    <root level="INFO">
      <appender-ref ref="STDOUT" />
    </root>
  </springProfile>

</configuration>